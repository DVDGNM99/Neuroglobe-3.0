# Neuroglobe üß† üåç

A decoupled pipeline bridging the **Allen Institute Mouse Connectivity Atlas** with the **BrainGlobe** visualization ecosystem.

## ‚ö° Core Philosophy
To solve dependency conflicts between `allensdk` and `brainrender` (specifically VTK/Qt issues), this project operates in two strictly isolated domains communicating only via CSV files:

1.  **The Miner** (Environment: `allensdk`): Fetches, aggregates, and filters connectivity data.
2.  **The Viewer** (Environment: `brainglobe_render`): A Dear PyGui application for 3D rendering.

## üì¶ Installation

This project requires **Conda**. Create the two isolated environments using the provided YAML files:

```bash
# 1. Environment for Data Mining (AllenSDK)
conda env create -f envs/allensdk.yml

# 2. Environment for Visualization (BrainGlobe + GUI)
conda env create -f envs/brainglobe_render.yml
```

## üöÄ Usage Workflow

### Step 1: Data Mining (The Miner)
**Environment:** `allensdk`

1.  **Configure:** Open `configs/mining_config.yaml` and set your target `seed_acronym` (e.g., `DR`, `MOp`) and filtering preferences.
2.  **Run Pipeline:**

```powershell
conda activate allensdk

# 1. Verify connection and find experiments
python src/miner/fetch.py

# 2. Download heavy data and aggregate stats (creates the master CSV)
python src/miner/aggregate.py

# 3. Create a clean subset for visualization (removes noise/parents)
python src/miner/filter_for_demo.py

### Step 2: Visualization (The Viewer)
**Environment:** `brainglobe_render`

1. **Switch Environment:**
```powershell
conda deactivate
conda activate brainglobe_render
```
2. **Launch GUI**
```powershell
python src/viewer/main.py
```
3.  **Interact:**
    * Click **LOAD CSV DATA**.
    * Navigate to `data/processed/` and select your filtered file (e.g., `DR_demo_filtered.csv`).
    * *Note: The injection site will be marked as `[SEED]` and rendered in black.*
    * Click **RENDER SCENE**.
## üìÇ Project Structure

* **`configs/`**: User control panels.
    * `mining_config.yaml`: Parameters for data extraction (Seed region, custom targets).
    * `visual_config.yaml`: Rendering settings.
    * `regions.json`: Ontology mapping for the GUI.

* **`data/`**: The "Handover Zone".
    * `raw/`: Managed by AllenSDK (manifests & HDF5 cache).
    * `processed/`: CSV files generated by the Miner, read by the Viewer.

* **`envs/`**: Conda environment specifications.
    * `allensdk.yml`: Python 3.10 environment for Domain A (Mining).
    * `brainglobe_render.yml`: Python 3.10 environment for Domain B (Viewer).

* **`src/`**: Source Code.
    * `miner/`: Scripts for API querying (`fetch.py`), aggregation (`aggregate.py`), and filtering (`filter_for_demo.py`).
    * `viewer/`: GUI logic (`main.py`, `logic.py`) and Brainrender integration (`rendering.py`).

---
*Created by [DVDGNM99](https://github.com/DVDGNM99)*